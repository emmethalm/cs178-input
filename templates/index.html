<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Weekly Calendar</title>
<style>

  body {
    background-color: #f4f7f6;
    color: #333;
    font-family: 'Arial', sans-serif;
  }
  .calendar {
    display: grid;
    grid-template-columns: 100px repeat(7, 1fr); /* 100px for the hour column, and 1 fraction each for the 7 days */
    grid-gap: 1px;
    text-align: center;
    margin: auto;
    max-width: 960px;
  }
  .hour-header, .day-header {
    font-weight: bold;
    background-color: #2c3e50;
    color: #ffffff;
    padding: 10px;
    border: 1px solid #2c3e50;
  }
  .time-slot {
    padding: 10px;
    border: 1px solid #bdc3c7;
    background-color: #ecf0f1;
    cursor: pointer;
    min-height: 50px; /* Adjust the height of the time slots */
  }
  .time-slot.selected {
    background-color: #3498db;
    color: #ffffff
  }
  .intro {
    text-align: center;
    margin-bottom: 20px;
  }
  .intro h1 {
    margin-bottom: 0.5em;
    color: #2c3e50
  }
  .intro p {
    max-width: 600px;
    margin-left: auto;
    margin-right: auto;
    line-height: 1.6;
    color: #34495e;
  }

</style>
</head>
<body>

  <div class="intro">
    <h1>Please fill in your availability below!</h1>
    <p>You have been invited to a meeting by <strong>Elena Glassman</strong> with the meeting subject <strong>CS178 Final Project</strong>. There are <strong>5</strong> other invitees. 
    Please indicate your availability below as well as the minimum number of attendees who must be present in order for you to join the meeting. Happy meeting!</p>
  </div>

<div class="container">
  <div class="calendar">
    <div class="hour-header">Hour</div> <!-- Static header for hours -->
    <div class="day-header">Sunday</div>
    <div class="day-header">Monday</div>
    <div class="day-header">Tuesday</div>
    <div class="day-header">Wednesday</div>
    <div class="day-header">Thursday</div>
    <div class="day-header">Friday</div>
    <div class="day-header">Saturday</div>

    {% for hour in range(24) %}
    <div class="hour-header">{{ hour }}:00</div> <!-- Hour header for each row -->
    {% for day in range(7) %}
    <div class="time-slot" data-day="{{ day }}" data-hour="{{ hour }}">
      <!-- Time slots will be here -->
    </div>
    {% endfor %}
    {% endfor %}
  </div>
</div>

<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<script>
  let isMouseDown = false;
  let selectedHours = [];

  $(document).on('mousedown', '.time-slot', function() {
    isMouseDown = true;
    $(this).toggleClass('selected');
    updateSelectedHours($(this));
    return false; // prevent text selection
  })
  .on('mouseover', '.time-slot', function() {
    if (isMouseDown) {
      $(this).toggleClass('selected');
      updateSelectedHours($(this));
    }
  })
  .on('mouseup', function() {
    isMouseDown = false;
  });

  function updateSelectedHours(element) {
    let day = element.data('day');
    let hour = element.data('hour');
    let id = 'day-' + day + '-hour-' + hour;
    let index = selectedHours.indexOf(id);
    if (index > -1) {
      selectedHours.splice(index, 1);
    } else {
      selectedHours.push(id);
    }
  }

  // Bind to a button click to submit the data
  $('#submit').click(function() {
    $.ajax({
      url: '/availability',
      type: 'POST',
      contentType: 'application/json',
      data: JSON.stringify({availability: selectedHours}),
      success: function(response) {
        alert(response.message);
      }
    });
  });

  // Prevent the default right click context menu on time slots
  $('.time-slot').on('contextmenu', function() {
    return false;
  });
</script>

</body>
</html>
